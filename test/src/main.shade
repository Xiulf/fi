module Main =

import Core
import Data.List (first)
import Monad.Writer
import Monad.Reader
import Monad.State
import Js.Console


@main
main :: Option ()
main = try
    a <- Some { a = 23, b = 24, c = 25 }
    let _, b = runWriter test
    let c = runReader test2 ("a":"b":Nil)
    let d = runState test3 234
    ret $ print a b c d

test :: Writer Str ()
test = try
    write "abc"
    write "def"
    write "ghi"
    ret ()

test2 :: forall a. Reader (List a) (Option a)
test2 = try
    a <- read
    ret $ first a

test3 :: State Int ()
test3 = try
    a <- get
    put 12
    let _ = print a :: ()
    ret ()
